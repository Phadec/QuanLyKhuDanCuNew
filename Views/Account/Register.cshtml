@model QuanLyKhuDanCu.ViewModels.RegisterViewModel

@{
    ViewData["Title"] = "Đăng ký";
    Layout = "_LayoutAuth";
}

<div class="container">
    <div class="row justify-content-center">
        <div class="col-lg-7">
            <div class="auth-logo">
                <img src="~/images/logo.png" alt="Logo Khu Dân Cư" onerror="this.src='data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%22100%22%20height%3D%22100%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2080%2080%22%20preserveAspectRatio%3D%22none%22%3E%3Cdefs%3E%3ClinearGradient%20id%3D%22grad%22%20x1%3D%220%25%22%20y1%3D%220%25%22%20x2%3D%22100%25%22%20y2%3D%22100%25%22%3E%3Cstop%20offset%3D%220%25%22%20style%3D%22stop-color%3A%231a4a73%3Bstop-opacity%3A1%22%20%2F%3E%3Cstop%20offset%3D%22100%25%22%20style%3D%22stop-color%3A%233498db%3Bstop-opacity%3A1%22%20%2F%3E%3C%2FlinearGradient%3E%3C%2Fdefs%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20fill%3D%22url%28%23grad%29%22%20d%3D%22M40%2038.5l-18%2011.2V34.2L40%2023l18%2011.2v15.5z%22%2F%3E%3Cpath%20fill%3D%22%232980b9%22%20d%3D%22M40%2057l-18-11.2L40%2034.6l18%2011.2z%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E';" />
                <h2 class="brand-text">Quản Lý Khu Dân Cư</h2>
            </div>
            <div class="auth-card shadow-lg border-0 rounded-lg">
                <div class="auth-card-header">
                    <h3 class="text-center font-weight-light my-2">
                        <i class="fas fa-user-plus text-primary me-2"></i>Đăng ký tài khoản
                    </h3>
                </div>
                <div class="auth-card-body">
                    <form asp-controller="Account" asp-action="Register" asp-route-returnurl="@ViewData["ReturnUrl"]" method="post" class="needs-validation" novalidate>
                        <div asp-validation-summary="ModelOnly" class="auth-validation-summary" role="alert">
                            <ul></ul>
                        </div>
                        
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <div class="form-floating mb-3 auth-form-floating">
                                    <input asp-for="HoTen" class="form-control" id="inputHoTen" placeholder="Họ và Tên" required />
                                    <label asp-for="HoTen" for="inputHoTen"><i class="fas fa-user me-2"></i>Họ và Tên</label>
                                    <span asp-validation-for="HoTen" class="auth-validation-error"></span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-floating mb-3 auth-form-floating">
                                    <input asp-for="Email" class="form-control" id="inputEmail" placeholder="name@example.com" required />
                                    <label asp-for="Email" for="inputEmail"><i class="fas fa-envelope me-2"></i>Email</label>
                                    <span asp-validation-for="Email" class="auth-validation-error"></span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <div class="form-floating mb-3 auth-form-floating">
                                    <input asp-for="SoDienThoai" class="form-control" id="inputSoDienThoai" placeholder="Số điện thoại" required />
                                    <label asp-for="SoDienThoai" for="inputSoDienThoai"><i class="fas fa-phone me-2"></i>Số điện thoại</label>
                                    <span asp-validation-for="SoDienThoai" class="auth-validation-error"></span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-floating mb-3 auth-form-floating">
                                    <input asp-for="CMND" class="form-control" id="inputCMND" placeholder="CMND/CCCD" required />
                                    <label asp-for="CMND" for="inputCMND"><i class="fas fa-id-card me-2"></i>CMND/CCCD</label>
                                    <span asp-validation-for="CMND" class="auth-validation-error"></span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-floating mb-3 auth-form-floating">
                            <input type="date" asp-for="NgaySinh" class="form-control" id="inputNgaySinh" required />
                            <label asp-for="NgaySinh" for="inputNgaySinh"><i class="fas fa-calendar me-2"></i>Ngày sinh</label>
                            <span asp-validation-for="NgaySinh" class="auth-validation-error"></span>
                        </div>
                        
                        <div class="form-floating mb-3 auth-form-floating">
                            <input asp-for="DiaChi" class="form-control" id="inputDiaChi" placeholder="Địa chỉ" required />
                            <label asp-for="DiaChi" for="inputDiaChi"><i class="fas fa-home me-2"></i>Địa chỉ</label>
                            <span asp-validation-for="DiaChi" class="auth-validation-error"></span>
                        </div>
                        
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <div class="form-floating mb-3 auth-password-container">
                                    <input asp-for="Password" class="form-control" id="inputPassword" placeholder="Mật khẩu" required />
                                    <label asp-for="Password" for="inputPassword"><i class="fas fa-lock me-2"></i>Mật khẩu</label>
                                    <button type="button" class="btn auth-toggle-password" tabindex="-1" aria-label="Hiển thị mật khẩu">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <span asp-validation-for="Password" class="auth-validation-error"></span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-floating mb-3 auth-password-container">
                                    <input asp-for="ConfirmPassword" class="form-control" id="inputConfirmPassword" placeholder="Xác nhận mật khẩu" required />
                                    <label asp-for="ConfirmPassword" for="inputConfirmPassword"><i class="fas fa-key me-2"></i>Xác nhận mật khẩu</label>
                                    <button type="button" class="btn auth-toggle-password" tabindex="-1" aria-label="Hiển thị mật khẩu">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <span asp-validation-for="ConfirmPassword" class="auth-validation-error"></span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-check mb-4">
                            <input class="form-check-input" type="checkbox" id="agreeTerms" required />
                            <label class="form-check-label" for="agreeTerms">
                                Tôi đồng ý với <a href="#" data-bs-toggle="modal" data-bs-target="#termsModal">điều khoản sử dụng</a> và <a href="#" data-bs-toggle="modal" data-bs-target="#privacyModal">chính sách bảo mật</a>
                            </label>
                            <div class="invalid-feedback">
                                Bạn phải đồng ý với điều khoản để tiếp tục.
                            </div>
                        </div>
                        
                        <div class="d-grid gap-2 mt-4">
                            <button type="submit" class="btn auth-btn-primary py-3">
                                <i class="fas fa-user-plus me-2"></i> Đăng ký tài khoản
                            </button>
                        </div>
                    </form>
                </div>
                <div class="auth-card-footer text-center py-3">
                    <div class="small">
                        <a href="/Account/Login" class="btn btn-outline-secondary">
                            <i class="fas fa-arrow-left me-1"></i> Quay lại đăng nhập
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Terms Modal -->
<div class="modal fade" id="termsModal" tabindex="-1" aria-labelledby="termsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable">
        <div class="auth-modal-content">
            <div class="auth-modal-header">
                <h5 class="modal-title" id="termsModalLabel">Điều khoản sử dụng</h5>
                <button type="button" class="btn-close auth-btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <h6>1. Điều khoản chung</h6>
                <p>Bằng việc truy cập và sử dụng hệ thống Quản lý Khu dân cư, bạn đồng ý tuân thủ các điều khoản và điều kiện sử dụng được quy định tại đây.</p>
                
                <h6>2. Quyền và trách nhiệm của người dùng</h6>
                <p>Người dùng có trách nhiệm bảo mật thông tin tài khoản của mình và chịu trách nhiệm về mọi hoạt động diễn ra dưới tài khoản đó.</p>
                <p>Người dùng cam kết cung cấp thông tin chính xác, đầy đủ khi đăng ký và sử dụng dịch vụ.</p>
                
                <h6>3. Quyền sở hữu trí tuệ</h6>
                <p>Tất cả nội dung, thiết kế, giao diện người dùng, biểu tượng và mã nguồn của hệ thống đều thuộc quyền sở hữu của Ban quản lý Khu dân cư.</p>
                
                <h6>4. Giới hạn trách nhiệm</h6>
                <p>Ban quản lý không chịu trách nhiệm về bất kỳ thiệt hại nào phát sinh từ việc sử dụng hoặc không thể sử dụng dịch vụ.</p>
            </div>
            <div class="auth-modal-footer">
                <button type="button" class="btn auth-btn-primary" data-bs-dismiss="modal">Đồng ý</button>
            </div>
        </div>
    </div>
</div>

<!-- Privacy Modal -->
<div class="modal fade" id="privacyModal" tabindex="-1" aria-labelledby="privacyModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable">
        <div class="auth-modal-content">
            <div class="auth-modal-header">
                <h5 class="modal-title" id="privacyModalLabel">Chính sách bảo mật</h5>
                <button type="button" class="btn-close auth-btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <h6>1. Thu thập thông tin</h6>
                <p>Chúng tôi thu thập thông tin cá nhân như họ tên, email, số điện thoại, CMND/CCCD, địa chỉ và ngày sinh để phục vụ cho việc quản lý khu dân cư.</p>
                
                <h6>2. Sử dụng thông tin</h6>
                <p>Thông tin cá nhân của bạn sẽ được sử dụng để xác thực danh tính, cung cấp dịch vụ, thông báo và quản lý các hoạt động trong khu dân cư.</p>
                
                <h6>3. Bảo mật thông tin</h6>
                <p>Chúng tôi cam kết bảo vệ thông tin cá nhân của bạn bằng các biện pháp bảo mật phù hợp và không chia sẻ thông tin với bên thứ ba khi chưa được sự đồng ý.</p>
                
                <h6>4. Quyền của người dùng</h6>
                <p>Bạn có quyền truy cập, chỉnh sửa hoặc yêu cầu xóa thông tin cá nhân của mình trong hệ thống.</p>
            </div>
            <div class="auth-modal-footer">
                <button type="button" class="btn auth-btn-primary" data-bs-dismiss="modal">Đồng ý</button>
            </div>
        </div>
    </div>
</div>

@section Styles {
    <style>
        .btn-outline-secondary {
            padding: 0.5rem 1rem;
            transition: all 0.3s ease;
        }
        
        .btn-outline-secondary:hover {
            background-color: var(--secondary-color);
            color: white;
        }
        
        .form-check-input:checked {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
        }
    </style>
}

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Toggle password visibility
            const togglePasswordButtons = document.querySelectorAll('.auth-toggle-password');
            togglePasswordButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const input = this.parentElement.querySelector('input');
                    if (input.type === 'password') {
                        input.type = 'text';
                        this.querySelector('i').classList.remove('fa-eye');
                        this.querySelector('i').classList.add('fa-eye-slash');
                    } else {
                        input.type = 'password';
                        this.querySelector('i').classList.remove('fa-eye-slash');
                        this.querySelector('i').classList.add('fa-eye');
                    }
                });
            });
            
            // Form validation
            const forms = document.querySelectorAll('.needs-validation');
            Array.from(forms).forEach(form => {
                form.addEventListener('submit', event => {
                    if (!form.checkValidity()) {
                        event.preventDefault();
                        event.stopPropagation();
                    }
                    form.classList.add('was-validated');
                }, false);
            });
            
            // Set max date for date of birth (must be at least 18 years old)
            const today = new Date();
            const maxDate = new Date(today.getFullYear() - 18, today.getMonth(), today.getDate());
            const dateInput = document.getElementById('inputNgaySinh');
            dateInput.max = maxDate.toISOString().split('T')[0];
        });
    </script>
}
